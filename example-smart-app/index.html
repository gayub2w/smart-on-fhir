<!DOCTYPE html>
<html lang="en" hidden>
  <head>
	  
	  	   <!-- Application-level javascript-->
    <script src='./src/js/example-smart-app.js'></script>
	<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"> 
    <meta http-equiv='X-UA-Compatible' content='IE=edge' />
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	 <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>  
	  
	  
    <title>Example-SMART-App</title>
 
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel='stylesheet' type='text/css' href='./src/css/example-smart-app.css'>
    <link rel='stylesheet' type='text/css' href='./lib/css/cerner-smart-embeddable-lib-1.0.0.min.css'>
	  
	  <style>
.button {
    background-color: #0079BE; 
    border: none;
    color: white;
    padding: 5px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
	font-size: 14px;
    margin: 4px 2px;
    cursor: pointer;
}

.button1 {border-radius: 2px;}
.button2 {border-radius: 4px;}
.button3 {border-radius: 4px;width: 100px; }
.button4 {border-radius: 4px;}
.button5 {border-radius: 50%;}
</style>	
  </head>
  <body>

	<p id='pract_id' ></p></t>
	<p id='pract_name' ></p>
	  
    <div id='holder' >
      <h2>Patient Info</h2>
      <table>
	<tr>
          <th>First Name:</th>
          <td id='fname'></td>
        </tr>
        <tr>
          <th>Last Name:</th>
          <td id='lname'></td>
        </tr>
	     
        <tr>
          <th>ID</th>
          <td id='id'></td>
        </tr>
      </table>
	    </div>
	<h2 style="margin-left:0.5em;">Order</h2>
<p style="margin-left:1em;">Select an instrument from the drop-down list:</p>

<div style="position:relative;width:200px;height:25px;border:0;padding:0;margin:0;">
  <select id="selectform" style="position:absolute;top:0px;left:0px;width:400px; height:25px;line-height:20px;margin-left:1em;padding:0;"
          onchange="document.getElementById('displayValue').value=this.options[this.selectedIndex].text; document.getElementById('idValue').value=this.options[this.selectedIndex].value;">
    <option></option>
   

  </select>
 </br>
</br>
  <button class="button button3" style="margin-left:1em;" type="button" onclick="alert('Test!')">Order</button>
</div>

 
    </br>
	</br>
    </br>

<h2 style="margin-left:0.5em;">Recommendations</h2>



<div id="content">
</div>
		<script>
			var Server = "https://www.assessmentcenter.net/ac_api";
				var FormOID = "96FE494D-F176-4EFB-A473-2AB406610626";  // Sample form -- replace with your FormOID

				var promisUID="001";
				
				function callback1(data){
				console.log(data);
			
			}
			
		
		function listForms() {
					$.ajax({
						url: Server + "/2014-01/Forms/.json",
						cache: false,
						type: "POST",
						data: "",
						dataType: "json",

						beforeSend: function(xhr) {
						 var Reg = "2807BB48-28D3-4FFA-823A-F5E7EBF7E52D";
						 var Token = "A0159F7B-E971-46E6-B62D-7A6085F53F19";
						
						 var base64 = btoa(Reg + ":" + Token);
						xhr.setRequestHeader("Authorization", "Basic " + base64);
						},

							success: function(data) { 
							
								console.log(data);
								//callback1(data);
								//console.log("am here");	
								var container = document.getElementById("Content");
								var forms = data.Form;
								
								var select = document.getElementById("selectform"); 
								

								//console.log("all forms"+forms);
								for (var i=0; i < forms.length; i++) {
									var opt = forms[i].Name;
									var el = document.createElement("option");
									el.textContent = opt;
									el.value = opt;
									select.appendChild(el);
								
									//console.log(forms[i].OID + " : " + forms[i].Name + "");
									//var myform = document.createElement("div");
									//myform.innerHTML = forms[i].OID + " : " + forms[i].Name + "";
									//container.appendChild(myform);
								}
								
							},
						
							error: function(jqXHR, textStatus, errorThrown) {
								document.write(jqXHR.responseText + ':' + textStatus + ':' + errorThrown);
							}
						});
				}	
			
			
			
			
			listForms();
			
		</script>	

  
    <!-- Required JS files to enable this page to embed within an MPage -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.min.js'></script>
    <script src='./lib/js/cerner-smart-embeddable-lib-1.0.0.min.js'></script>

   

    <!-- FHIR Client JS Library -->
    <script src='./lib/js/fhir-client-v0.1.12.js'></script>

    <!-- Prevent session bleed caused by single threaded embedded browser and sessionStorage API -->
    <!-- https://github.com/cerner/fhir-client-cerner-additions -->
    <script src='./lib/js/fhir-client-cerner-additions-1.0.0.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>
      extractData().then(
        //Display Patient Demographics and Observations if extractData was success
        function(p) {
          drawVisualization(p);
        },

        //Display 'Failed to call FHIR Service' if extractData failed
        function() {
          $('#loading').hide();
          $('#errors').html('<p> Failed to call FHIR Service </p>');
        }
      );
    </script>
  </body>
</html>
